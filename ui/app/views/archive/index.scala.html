@*{<meta charset="UTF-8" />}*@

@import node.list
@import org.apache.commons.collections.CollectionUtils

@(repositoryId:String)(archives:java.util.List[model.Archive])

<!DOCTYPE html>
<html>
	@header()
	<body>
		@menubar(repositoryId)
		
		<div class="container">
			<div class="row">
	  			<div class="col-xs-12">
	  				<h3><i class="fa fa-trash"></i>@Messages("view.archive.caption")</h3>
	  			</div>
	  		</div>
	  	
	  		<div class="row">
	  			<div class="col-xs-12">
	  				<table class="footable" id="archive-table" data-sort="true">
							<thead>
								<tr>
									<th data-sort-initial="true">アーカイブID</th>
									<th>名前</th>
									<th data-sort-ignore="true" class="col-xs-2">@Messages("view.action")</th>
								</tr>
							</thead>
							<tbody>
								@for(archive <- archives; if(CollectionUtils.isNotEmpty(archives))){
									<tr>
										<td>@archive.id</td>
										<td>@archive.name</td>
										<td>
											<button type='button' class='btn btn-default archive-restore' archive-id='@archive.id'><i class="fa fa-wrench"></i>復元</button>
											<button type='button' class='btn btn-default archive-delete' user-id='@archive.id'><i class="fa fa-trash"></i>@Messages("view.delete")</button>
										</td>
									</tr>
								}
							</tbody>
							<tfoot>
								<tr>
									@defining(play.Play.application().configuration().getStringList("navigation.column.displayed").size() + 2){colSpan =>
										<td colspan="@colSpan">
									}
										<div class="pagination pagination-centered hide-if-no-paging"></div>
									</td>
								</tr>
							</tfoot>
						</table>
	  			</div>
	  		</div>
	  	
	  	</div>
	  	
	  	<script type="text/javascript">
		  	$(function(){
			  	$("button.archive-restore").on('click', function(e){
			  		var archiveId = $(this).attr("archive-id");
		  			$.ajax(jsRoutes.controllers.Archive.restore("@repositoryId", archiveId))
		  			.done(function(data){
		  				location.reload(jsRoutes.controllers.Archive.index("@repositoryId"));
		  			}).fail(function(data){
		  				alert('復元に失敗しました');
		  			}).complete(function(data){
		  				
		  			});
		  		});
		  	});
	  	</script>
	</body>
</html>