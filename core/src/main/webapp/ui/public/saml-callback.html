<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/core/ui/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAML Callback - NemakiWare</title>
    <!--
      SAML Callback Page

      This page handles the SAML redirect callback from Keycloak (or other SAML IdPs).
      It loads the same React SPA assets as index.html, allowing the Login component
      to detect the callback URL and process the SAML response.

      Flow:
      1. User clicks "SAML認証でログイン" on login page
      2. SAMLService.initiateLogin() redirects to IdP SSO URL with SAMLRequest
      3. User authenticates at IdP
      4. IdP redirects to: /core/ui/saml-callback.html?SAMLResponse=xxx&RelayState=xxx
      5. This page loads and initializes the React app
      6. Login.tsx detects pathname includes 'saml-callback'
      7. Login.tsx calls handleSAMLCallback() to process the SAML response
      8. SAMLService.handleSAMLResponse() converts SAML response to NemakiWare auth token
      9. User is logged in and can access the application

      Note: The script and style URLs must match those in index.html.
      When rebuilding the UI, these may need to be updated if the hash changes.
    -->
    <script type="module" crossorigin src="/core/ui/assets/index-Cy-g0QIB.js"></script>
    <link rel="stylesheet" crossorigin href="/core/ui/assets/index-BaB_POPR.css">
    <style>
      /* Loading indicator while React initializes */
      .saml-loading {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }
      .saml-loading h2 {
        color: #333;
        margin-bottom: 16px;
      }
      .saml-loading p {
        color: #666;
      }
      .saml-spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #1890ff;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: saml-spin 1s linear infinite;
        margin: 20px 0;
      }
      @keyframes saml-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      /* Hide loading indicator once React mounts */
      #root:not(:empty) + .saml-loading {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <!-- Loading indicator shown until React app mounts -->
    <div class="saml-loading">
      <h2>SAML認証処理中...</h2>
      <div class="saml-spinner"></div>
      <p>認証が完了するまでお待ちください。</p>
    </div>
  </body>
</html>
